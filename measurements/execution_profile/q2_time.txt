with Profile() as profile:
    result = q2_time(project_id, dataset, table)
    print_result(result)
    (
        Stats(profile)
        .strip_dirs()
        .sort_stats(SortKey.TIME)
        .print_stats('q2_time.py')
    )

('ğŸ™', 7286)
('ğŸ˜‚', 3072)
('ğŸšœ', 2972)
('ğŸŒ¾', 2363)
('ğŸ‡®', 2096)
('ğŸ‡³', 2094)
('ğŸ»', 2080)
('ğŸ¤£', 1668)
('ğŸ½', 1218)
('ğŸ‘‡', 1108)


26233 function calls (25715 primitive calls) in 1.489 seconds

   Ordered by: internal time
   List reduced from 1145 to 1 due to restriction <'q2_time.py'>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.489    1.489 q2_time.py:6(q2_time)